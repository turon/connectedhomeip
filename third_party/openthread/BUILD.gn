#  Copyright (c) 2019, The OpenThread Authors.
#  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without
#  modification, are permitted provided that the following conditions are met:
#  1. Redistributions of source code must retain the above copyright
#     notice, this list of conditions and the following disclaimer.
#  2. Redistributions in binary form must reproduce the above copyright
#     notice, this list of conditions and the following disclaimer in the
#     documentation and/or other materials provided with the distribution.
#  3. Neither the name of the copyright holder nor the
#     names of its contributors may be used to endorse or promote products
#     derived from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
#  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
#  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
#  ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE
#  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
#  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
#  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
#  INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
#  CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
#  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
#  POSSIBILITY OF SUCH DAMAGE.
#

config("openthread_config") {
  include_dirs = [
    "repo/include",
    "repo/src",
    "repo/src/core",
    "repo/src/ncp",
    "repo/third_party",
    "repo/third_party/mbedtls",
    "repo/third_party/mbedtls/repo/include"
  ]

  defines = [
    "MBEDTLS_CONFIG_FILE=\"mbedtls-config.h\"",
    "OPENTHREAD_FTD=1",
    "SPINEL_PLATFORM_HEADER=\"spinel_platform.h\"",
    "OPENTHREAD_CONFIG_FILE=<openthread-config-android.h>",
    "PACKAGE_NAME=\"OPENTHREAD-CORE\"",
    "PACKAGE_VERSION=\"1.0.0\""
  ]
}

static_library("lib-ot-core") {

 cflags_cc = [ "-Wno-non-virtual-dtor" ]

 sources = [
    "repo/src/core/api/backbone_router_api.cpp",
    "repo/src/core/api/backbone_router_ftd_api.cpp",
    "repo/src/core/api/border_agent_api.cpp",
    "repo/src/core/api/border_router_api.cpp",
    "repo/src/core/api/channel_manager_api.cpp",
    "repo/src/core/api/channel_monitor_api.cpp",
    "repo/src/core/api/child_supervision_api.cpp",
    "repo/src/core/api/coap_api.cpp",
    "repo/src/core/api/coap_secure_api.cpp",
    "repo/src/core/api/commissioner_api.cpp",
    "repo/src/core/api/crypto_api.cpp",
    "repo/src/core/api/dataset_api.cpp",
    "repo/src/core/api/dataset_ftd_api.cpp",
    "repo/src/core/api/diags_api.cpp",
    "repo/src/core/api/dns_api.cpp",
    "repo/src/core/api/entropy_api.cpp",
    "repo/src/core/api/heap_api.cpp",
    "repo/src/core/api/icmp6_api.cpp",
    "repo/src/core/api/instance_api.cpp",
    "repo/src/core/api/ip6_api.cpp",
    "repo/src/core/api/jam_detection_api.cpp",
    "repo/src/core/api/joiner_api.cpp",
    "repo/src/core/api/link_api.cpp",
    "repo/src/core/api/link_raw_api.cpp",
    "repo/src/core/api/logging_api.cpp",
    "repo/src/core/api/message_api.cpp",
    "repo/src/core/api/netdata_api.cpp",
    "repo/src/core/api/network_time_api.cpp",
    "repo/src/core/api/random_crypto_api.cpp",
    "repo/src/core/api/random_noncrypto_api.cpp",
    "repo/src/core/api/server_api.cpp",
    "repo/src/core/api/sntp_api.cpp",
    "repo/src/core/api/tasklet_api.cpp",
    "repo/src/core/api/thread_api.cpp",
    "repo/src/core/api/thread_ftd_api.cpp",
    "repo/src/core/api/udp_api.cpp",
    "repo/src/core/backbone_router/bbr_leader.cpp",
    "repo/src/core/backbone_router/bbr_local.cpp",
    "repo/src/core/coap/coap.cpp",
    "repo/src/core/coap/coap_message.cpp",
    "repo/src/core/coap/coap_secure.cpp",
    "repo/src/core/common/crc16.cpp",
    "repo/src/core/common/extension_example.cpp",
    "repo/src/core/common/instance.cpp",
    "repo/src/core/common/logging.cpp",
    "repo/src/core/common/message.cpp",
    "repo/src/core/common/notifier.cpp",
    "repo/src/core/common/random_manager.cpp",
    "repo/src/core/common/settings.cpp",
    "repo/src/core/common/string.cpp",
    "repo/src/core/common/tasklet.cpp",
    "repo/src/core/common/timer.cpp",
    "repo/src/core/common/tlvs.cpp",
    "repo/src/core/common/trickle_timer.cpp",
    "repo/src/core/crypto/aes_ccm.cpp",
    "repo/src/core/crypto/aes_ecb.cpp",
    "repo/src/core/crypto/ecdsa.cpp",
    "repo/src/core/crypto/hmac_sha256.cpp",
    "repo/src/core/crypto/mbedtls.cpp",
    "repo/src/core/crypto/pbkdf2_cmac.cpp",
    "repo/src/core/crypto/sha256.cpp",
    "repo/src/core/diags/factory_diags.cpp",
    "repo/src/core/mac/channel_mask.cpp",
    "repo/src/core/mac/data_poll_handler.cpp",
    "repo/src/core/mac/data_poll_sender.cpp",
    "repo/src/core/mac/link_raw.cpp",
    "repo/src/core/mac/mac.cpp",
    "repo/src/core/mac/mac_filter.cpp",
    "repo/src/core/mac/mac_frame.cpp",
    "repo/src/core/mac/mac_types.cpp",
    "repo/src/core/mac/sub_mac_callbacks.cpp",
    "repo/src/core/mac/sub_mac.cpp",
    "repo/src/core/meshcop/announce_begin_client.cpp",
    "repo/src/core/meshcop/border_agent.cpp",
    "repo/src/core/meshcop/commissioner.cpp",
    "repo/src/core/meshcop/dataset.cpp",
    "repo/src/core/meshcop/dataset_local.cpp",
    "repo/src/core/meshcop/dataset_manager.cpp",
    "repo/src/core/meshcop/dataset_manager_ftd.cpp",
    "repo/src/core/meshcop/dtls.cpp",
    "repo/src/core/meshcop/energy_scan_client.cpp",
    "repo/src/core/meshcop/joiner.cpp",
    "repo/src/core/meshcop/joiner_router.cpp",
    "repo/src/core/meshcop/meshcop.cpp",
    "repo/src/core/meshcop/meshcop_leader.cpp",
    "repo/src/core/meshcop/meshcop_tlvs.cpp",
    "repo/src/core/meshcop/panid_query_client.cpp",
    "repo/src/core/meshcop/timestamp.cpp",
    "repo/src/core/net/dhcp6_client.cpp",
    "repo/src/core/net/dhcp6_server.cpp",
    "repo/src/core/net/dns_client.cpp",
    "repo/src/core/net/icmp6.cpp",
    "repo/src/core/net/ip6_address.cpp",
    "repo/src/core/net/ip6.cpp",
    "repo/src/core/net/ip6_filter.cpp",
    "repo/src/core/net/ip6_headers.cpp",
    "repo/src/core/net/ip6_mpl.cpp",
    "repo/src/core/net/netif.cpp",
    "repo/src/core/net/sntp_client.cpp",
    "repo/src/core/net/udp6.cpp",
    "repo/src/core/radio/radio_callbacks.cpp",
    "repo/src/core/radio/radio_platform.cpp",
    "repo/src/core/thread/address_resolver.cpp",
    "repo/src/core/thread/announce_begin_server.cpp",
    "repo/src/core/thread/announce_sender.cpp",
    "repo/src/core/thread/child_table.cpp",
    "repo/src/core/thread/discover_scanner.cpp",
    "repo/src/core/thread/dua_manager.cpp",
    "repo/src/core/thread/energy_scan_server.cpp",
    "repo/src/core/thread/indirect_sender.cpp",
    "repo/src/core/thread/key_manager.cpp",
    "repo/src/core/thread/link_quality.cpp",
    "repo/src/core/thread/lowpan.cpp",
    "repo/src/core/thread/mesh_forwarder.cpp",
    "repo/src/core/thread/mesh_forwarder_ftd.cpp",
    "repo/src/core/thread/mesh_forwarder_mtd.cpp",
    "repo/src/core/thread/mle.cpp",
    "repo/src/core/thread/mle_router.cpp",
    "repo/src/core/thread/mle_types.cpp",
    "repo/src/core/thread/network_data.cpp",
    "repo/src/core/thread/network_data_leader.cpp",
    "repo/src/core/thread/network_data_leader_ftd.cpp",
    "repo/src/core/thread/network_data_local.cpp",
    "repo/src/core/thread/network_data_notifier.cpp",
    "repo/src/core/thread/network_diagnostic.cpp",
    "repo/src/core/thread/panid_query_server.cpp",
    "repo/src/core/thread/router_table.cpp",
    "repo/src/core/thread/src_match_controller.cpp",
    "repo/src/core/thread/thread_netif.cpp",
    "repo/src/core/thread/time_sync_service.cpp",
    "repo/src/core/thread/topology.cpp",
    "repo/src/core/utils/channel_manager.cpp",
    "repo/src/core/utils/channel_monitor.cpp",
    "repo/src/core/utils/child_supervision.cpp",
    "repo/src/core/utils/heap.cpp",
    "repo/src/core/utils/jam_detector.cpp",
    "repo/src/core/utils/parse_cmdline.cpp",
    "repo/src/core/utils/slaac_address.cpp",
    "repo/src/lib/hdlc/hdlc.cpp",
    "repo/src/lib/spinel/spinel.c",
    "repo/src/lib/spinel/spinel_decoder.cpp",
    "repo/src/lib/spinel/spinel_encoder.cpp"
  ]

  if (current_os == "linux") {
    sources += [
      "repo/third_party/mbedtls/repo/library/md.c",
      "repo/third_party/mbedtls/repo/library/md_wrap.c",
      "repo/third_party/mbedtls/repo/library/memory_buffer_alloc.c",
      "repo/third_party/mbedtls/repo/library/platform.c",
      "repo/third_party/mbedtls/repo/library/platform_util.c",
      "repo/third_party/mbedtls/repo/library/sha256.c",
      "repo/third_party/mbedtls/repo/library/bignum.c",
      "repo/third_party/mbedtls/repo/library/ccm.c",
      "repo/third_party/mbedtls/repo/library/cipher.c",
      "repo/third_party/mbedtls/repo/library/cipher_wrap.c",
      "repo/third_party/mbedtls/repo/library/cmac.c",
      "repo/third_party/mbedtls/repo/library/ctr_drbg.c",
      "repo/third_party/mbedtls/repo/library/debug.c",
      "repo/third_party/mbedtls/repo/library/ecjpake.c",
      "repo/third_party/mbedtls/repo/library/ecp_curves.c",
      "repo/third_party/mbedtls/repo/library/entropy.c",
      "repo/third_party/mbedtls/repo/library/entropy_poll.c",
      "repo/third_party/mbedtls/repo/library/ssl_cookie.c",
      "repo/third_party/mbedtls/repo/library/ssl_ciphersuites.c",
      "repo/third_party/mbedtls/repo/library/ssl_cli.c",
      "repo/third_party/mbedtls/repo/library/ssl_srv.c",
      "repo/third_party/mbedtls/repo/library/ssl_ticket.c",
      "repo/third_party/mbedtls/repo/library/ssl_tls.c",
      "repo/third_party/mbedtls/repo/library/aes.c",
      "repo/third_party/mbedtls/repo/library/ecp.c"
    ]
  }

  # Remove the example as it is not meant for compilation
  sources -= [
    "repo/src/core/common/extension_example.cpp",
  ]

  public_configs = [ ":openthread_config" ]
}
